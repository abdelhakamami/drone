kind: pipeline
name: remove-images
type: kubernetes 
steps:
  - name: remove-images
    image: lumir/remove-dockerhub-tag
    environment:
      - UNAME: abdelhakavaxia
      - TOKEN: dckr_pat_nmj1n6g5nQF07n7w5VHVaYsanTI
      - REPO: abdelhakavaxia/election-app-front-end
    commands:
      - rm -rf ~/.docker/config.json
      - docker login -u $UNAME -p $TOKEN
      - tags=$(curl -s https://hub.docker.com/v2/repositories/$UNAME/$REPO/tags?page_size=100 | jq -r '.results | .[] | .name' | tail -n 2)
      - for tag in $tags; do docker push $UNAME/$REPO:$tag; done

  



    
  
